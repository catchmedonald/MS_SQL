
--ASSIGNMENT - 7
--A-1 : EID, NAME, CITY OF GURGAON EMPLOYEES

SELECT EID, NAME, CITY FROM EMP WHERE CITY = 'GURGAON';

--A-2 : EID, NAME, DOJ ,DEPT, DESI & SALARY OF ALL MANAGERS

SELECT EMP.EID, NAME, DOJ, DEPT, DESI, SALARY 
FROM EMP 
JOIN EMP_SAL 
ON EMP.EID = EMP_SAL.EID
WHERE DESI LIKE '%MANAGER%';

--A-3: REDUCE THE SALARY OF ALL DELHI EMPLOYEES BY 10%.

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;

SELECT * FROM EMP_SAL
WHERE EID IN(SELECT EID FROM EMP WHERE CITY ='DELHI' );

UPDATE EMP_SAL
SET SALARY = (SALARY - (SALARY *0.10))
WHERE EID IN(SELECT EID FROM EMP WHERE CITY ='DELHI' );


--A-4 : DISPLAY THE EID, NAME , CITY, DOJ ,DEPT, DESI & SALARY OF THE TEAM
--MEMBERS OF DAVID & RAMESH SAHRMA.

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;

SELECT EMP.EID, NAME, CITY, DOJ, DEPT, DESI, SALARY FROM EMP
JOIN EMP_SAL
ON EMP.EID = EMP_SAL.EID
WHERE EMP.EID IN(SELECT EID FROM EMP_SAL
WHERE DEPT IN (SELECT DEPT FROM EMP_SAL WHERE EID IN (SELECT EID FROM EMP WHERE NAME LIKE '%DAVID%' OR NAME LIKE '%RAMESH SAHRMA%')))


--A-5: CREATE A TRAINING TABLE CONTAINING EID, NAME, DEPT. INSERT THE DETAILS
--OF OPS TEAM MEMBERS IN THE TRAINING TABLE.

CREATE TABLE TRAINING 
( EID CHAR(5),
NAME VARCHAR(30),
DEPT VARCHAR(20))


SELECT * FROM EMP;
SELECT * FROM EMP_SAL;
SELECT * FROM TRAINING;


INSERT INTO TRAINING (EID, NAME, DEPT)(
SELECT EMP.EID, NAME, DEPT 
FROM EMP
JOIN EMP_SAL
ON EMP.EID =EMP_SAL.EID
WHERE DEPT = 'OPS');

--A-6: DETAILS OF DIRECTORS SHOULD BE DELETED FROM THE TRAINING TABLE.

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;
SELECT * FROM TRAINING;

DELETE FROM TRAINING WHERE EID IN (SELECT EID FROM EMP_SAL WHERE DESI LIKE '%DIRECTOR%');


--A-7: DISPLAY THE SALARY DETAILS OFF ALL EMPLOYES IF ANY OF THE TEAM MEMBER
--HAS SALARY MORE THAN 200000.

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;
SELECT *  FROM EMP_SAL
WHERE EXISTS (SELECT * FROM EMP_SAL WHERE SALARY > 200000) 

--ASSIGNMENT -8

--A-1 : CREATE BELOW PROCEDURES IN THE INVENTORY DATABASE AS SPECIFIED :
--ADDSUPPLIER - SHOULD ADD THE SUPPLIER IN THE SUPLIER TABLE AND DISPLAY THE
--DETAILS OF THE NEW SUPPLIER ADDED.

CREATE PROCEDURE INS_SUP @SID AS CHAR(5), @SNAME VARCHAR(30), @SADD VARCHAR(50), @SPHONE VARCHAR(15), @EMAIL AS VARCHAR(30)
AS
BEGIN

		INSERT INTO SUPPLIER (SID, SNAME, SADD, SPHONE, EMAIL)
		VALUES (@SID, @SNAME, @SADD, @SPHONE, @EMAIL)

		SELECT * FROM SUPPLIER WHERE SID = @SID;

END

EXECUTE INS_SUP 'S0001', 'GOOGLE', 'TEXAS CITY', '1234567899', 'GOOGLE@GMAIL.COM'
EXEC INS_SUP 'S0001', 'GOOGLE', 'TEXAS CITY', '1234567899', 'GOOGLE@GMAIL.COM'
INS_SUP 'S0002', 'YAHOO', 'YAHOO CITY', '1234567989', 'YAHOO@yahoo.COM'

--ADDPRO - SHOULD ADD THE PRODUCT IN THE PRODUCT TABLE AND DISPLAY THE
--DETAILS OF THE NEW PRODUCT ADDED.

SELECT * FROM PRODUCT;
CREATE PROCEDURE ADDPRO @PID AS CHAR(5), @PDESC AS VARCHAR(40), @PRICE AS INT , @CATEGORY AS CHAR(2), @SID AS CHAR(5)
AS 
BEGIN
INSERT INTO PRODUCT (PID, PDESC, PRICE, CATEGORY, SID)
VALUES (@PID, @PDESC, @PRICE, @CATEGORY, @SID)
SELECT * FROM PRODUCT WHERE PID = @PID
END

ADDPRO 'P0001', 'GOOGLE CLOUD', '2000', 'IT', 'S0001' 

--ADDCUST - SHOULD ADD THE CUSTOMER IN THE CUSTOMER TABLE AND DISPLAY THE
--DETAILS OF THE NEW CUSTOMER ADDED.

SELECT * FROM CUST;
DROP PROCEDURE ADDCUST;
CREATE PROCEDURE ADDCUST @CID AS CHAR(5), @CNAME AS VARCHAR(30), @CADDRESS VARCHAR(50), @CITY VARCHAR(30), @PHONE VARCHAR(15), @EMAIL VARCHAR(30), @DOB DATE
AS
BEGIN
INSERT INTO CUST (CID, CNAME, CADDRESS, CITY, PHONE, EMAIL, DOB)
VALUES (@CID, @CNAME, @CADDRESS, @CITY, @PHONE, @EMAIL , @DOB)
SELECT *  FROM CUST WHERE CID = @CID
END

ADDCUST 'C0001', 'ARUN VIJAY', 'WATERFALL ROAD', 'CHENNAI', '7846546114', 'ARUNVI@GMAIL.COM','02-02-1990'

--ADDORDER - SHOULD ADD THE ORDER IN THE ORDERS TABLE AND DISPLAY THE DETAILS
--OF THE ORDER. ORDER DATE SHOULD BE CURRENT DATE AND SHOULD COME
--AUTOMATICALLY.

SELECT * FROM ORDERS;
CREATE PROCEDURE ADDORDER @OID AS CHAR(5), @CID AS CHAR(5), @PID AS CHAR(5), @OQTY AS INT
AS
BEGIN
INSERT INTO ORDERS (OID, ODATE, CID, PID, OQTY)
VALUES (@OID, GETDATE(), @CID, @PID, @OQTY)
 SELECT * FROM ORDERS WHERE OID = @OID
 END

ADDORDER 'O0001', 'C0001', 'P0001', 2


